jQuery(document).ready(function(a){a('button[name="sq_force_data_fetch_stop"]').on("click",function(e){e.preventDefault(),a(this).data("stop","true")}),a('button[name="sq_force_data_fetch"]').on("click",function(e){e.preventDefault();var t=this,o=a('button[name="sq_force_data_fetch_stop"]');a(t).prop("disabled",!0),a(o).addClass("enabled"),a.ajax({type:"post",dataType:"json",async:!0,url:stockQuoteJs.ajax_url,data:{action:"stockquote_purge_cache"}}).done(function(e){function s(){a.ajax({type:"post",dataType:"json",async:!0,url:stockQuoteJs.ajax_url,data:{action:"stockquote_update_quotes"}}).done(function(e){e.done||"true"==a(o).data("stop")?("DONE"!=e.message?a(".sq_force_data_fetch").append("<br />["+e.symbol+"] "+e.message):a(".sq_force_data_fetch").append("<br />DONE"),a(t).prop("disabled",!1),a(o).removeClass("enabled").data("stop","false")):(e.message.indexOf("Operation timed out")>=0?a(".sq_force_data_fetch").append("[Timeout] "+e.symbol+"<br />"):e.message.indexOf("Invalid API call")>=0?a(".sq_force_data_fetch").append("[Invalid API call] "+e.symbol+' (<a href="'+stockQuoteJs.avurl+e.symbol+'" target="_blank">test</a>)<br />'):a(".sq_force_data_fetch").append("[OK] "+e.symbol+"<br />"),setTimeout(function(){s()},2e3))}).fail(function(e){a(".sq_force_data_fetch").append("<br />[Error] "+e.message)})}a(".sq_force_data_fetch").html("Reset fetching loop and fetch data again. Please wait...<br /><br />"),s()})})});